HELO localhost
MAIL From:cedric@titi.com
RCPT To:rixed@happyleptic.org
DATA
From: cedric cellier <rixed@happyleptic.org>
To: xavier.mathieu@evistel.com
Subject: [Easy Recharge] Use Cases
Message-ID: <20070131122811.GA17382@fp-desktop.fr.evistel.com>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="gKMricLos+KVdGMg"
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
User-Agent: Mutt/1.5.13 (2006-08-11)
Status: RO
Content-Length: 8971
Lines: 185


--gKMricLos+KVdGMg
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: inline
Content-Transfer-Encoding: 8bit

Au fait, on a rédigé un début de use cases pour easy recharge.
Je te transmet en l'état, tu auras peut être des idées.



--gKMricLos+KVdGMg
Content-Type: text/plain; charset=iso-8859-1
Content-Disposition: attachment; filename="use_cases.txt"
Content-Transfer-Encoding: 8bit

Quelques scénarios permettant d'éclairer les aspects flous des besoins d'ATM, 
c'est à dire surtout sur ce qui se passe non pas entre les grands comptes mais 
près du marchand final. La base de donnée et l'IHM Web ont étés conçues pour 
gérer un arbre de vendeurs, mais cet aspect là des choses n'est peut être pas 
le plus important. Notamment, la hiérarchie entre vendeurs, les relations 
complexes entre vendeurs, comptes et utilisateurs, ne sont plus les mêmes si 
l'on se place près de la racine de l'arbre ou près d'une de ces plusieurs 
milliers de feuilles. L'arbre des vendeurs, c'est peut être l'arbre qui cache 
la forêt :-)


Scénario 1 : inscription d'un nouveau marchand

Le commercial C veut inscrire le marchand M et lui vendre une SIM (un compte) 
lui permettant de revendre ensuite du crédit aux abonnés prépayés d'ATM.

M donne son MSISDN à C qui envoie en USSD au service d'easy recharge : son 
login, son mot de passe, cet MSISDN de M et un login (de cinq lettres ou 
chiffres minimum) pour M. La réponse USSD valide la création du compte ou 
averti d'une erreur (login invalide car déjà pris, par exemple).  Dans la base 
de donnée, le compte du marchand M est alors crée mais avec un statut spécial 
signifiant "à valider".  Les droits de cet utilisateur sont minimalistes : 
droit de gérer des comptes, de transférer du crédit vers des abonnés, 
d'utiliser le service USSD, et des limites prédéfinies du nombre de transferts 
et du montant total transférable par jour (par exemple).  De plus, un mot de 
passe (contenant uniquement des chiffres) est créé, et envoyé par SMS au 
MSISDN de M dans le compte rendu de l'opération.  Ce mot de passe ne peut 
jamais être changé, ni être retrouvé (seul un hash - par exemple MD5 - est 
stocké dans la base).

Ce compte rendu reçu par M sur sa SIM personnelle l'averti de la création de 
son compte et de son code d'accès. Il doit alors activer son compte via USSD 
(spécification de son login et de son mot de passe). Les comptes non activés 
au bout d'un certain délais sont automatiquement détruits, ce qui nous évite 
d'avoir à implémenter une fonction de suppression en cas de saisie erronée 
(par exemple du MSISDN).

Le commercial C peut alors vendre un compte au marchand M, qui est alors un 
sous-vendeur.

Par sécurité et commodité, un SMS est également envoyé au commercial M, sur sa 
SIM personnelle, l'informant de l'activation du compte de M.

Notes à propos de la SIM émetrice des requêtes USSD : Dans les requêtes USSD, 
le login du requérant peut être facultatif dans la mesure où le mot de passe 
et le MSISDN de la SIM employé pour ce dialogue USSD sont suffisamment 
discriminants. Par ailleurs, chaque fois que l'on désigne un utilisateur dans 
une requête USSD, on doit théoriquement utiliser son login plutôt que son 
MSISDN personnel, car celui-ci peut être facultatif dans certains cas, et peut 
changer au fil du temps. Mais dans la pratique, les logins n'étant pas 
nécessairement numériques (et c'est une bonne chose qu'ils ne le soient pas), 
cela limite l'usage que l'on peut en faire en USSD (la première commande USSD 
devant être numérique uniquement). Donc, les commandes "courtes" doivent 
pouvoir désigner des utilisateurs par leur MSISDN personnel, tandis que les 
commandes longues doivent privilégier le login.

Notes à propos des SIM personnelles : Il n'est pas certain que les 
utilisateurs du service USSD souhaiteront utiliser les SIM des comptes 
manipulés pour envoyer des requêtes au service (surtout pour ceux qui gèrent 
plusieurs comptes). Voilà pourquoi dans ces scénarios on préfère prendre le 
cas où les utilisateurs emploient leurs SIM personnelles pour effectuer les 
opérations. Cela rajoute éventuellement un MSISDN sur les requêtes USSD (pour 
désigner le compte), et cela peut aussi poser un problème de sécurité. On 
propose donc qu'un utilisateur puisse employer sa SIM personnelle uniquement 
si son MSISDN est renseigné dans la base de donnée.  Tout ordre USSD sera 
invalide dès lors qu'il n'est émit ni d'une SIM supportant un compte 
renseigné, ni d'une SIM renseignée comme donnée personnelle de l'utilisateur.


Scénario 2 : vente d'un compte à un sous-vendeur.

Le commercial C, qui est gestionnaire de plusieurs comptes, dont le compte A1, 
crédité d'une certaine somme, souhaite déléguer ce compte au marchand M (en 
échange d'une somme équivalente au crédit disponible sur A1 augmentée d'une 
juste rétribution).

Il envoie une requête USSD au service avec, en plus de l'ordre de délégation :
- son mot de passe personnel,
- le MSISDN de A1,
- le login du marchand M ou son MSISDN (Cf notes ci-dessus).

Dans la réponse USSD le commercial C reçoit confirmation de la bonne exécution 
de sa requête ou un message d'erreur (par exemple s'il n'a pas le droit 
d'opérer cette délégation, si le destinataire n'est pas connu, etc). Le 
marchand M reçoit une notification par SMS l'informant de la nouvelle 
acquisition du compte (MSISDN de A1 et crédit disponible dessus).


Scénario 3 : vente de crédit à un abonné.

Le marchand M désire désormais revendre du crédit disponible sur le compte A1 
à un abonné d'ATM prépayé, P. Deux possibilité s'offrent à lui pour utiliser 
le service USSD : soit il émet à partir de la SIM du compte A1, soit il émet à 
partir de sa SIM personnelle, dont le MSISDN est renseigné dans la base.

Dans le premier cas, il envoie au service USSD, outre l'ordre de transfert : 
son login, son mot de passe, le MSISDN de P et le montant désiré.

Dans le deuxième cas, il envoie au service USSD, outre l'ordre de transfert : 
son login, son mot de passe, le MSISDN de A1, le MSISDN de P et le montant 
désiré.

La réponse USSD informe le marchand du bon déroulement de l'opération ou d'une 
éventuelle erreur (mauvais paramètre, crédit épuisés, etc).

Le destinataire reçoit un SMS de confirmation l'informant du nouveau solde de 
son compte.

La SIM du compte A1 reçoit également un SMS de notification résumant 
l'opération.


Scénario 4 : vente de crédit au marchand.

Le marchand M a presque épuisé le crédit disponible sur le compte A1, et le 
commercial C veut lui en revendre.

Ce dernier, en échange d'un paiement, veut transférer du crédit depuis le 
compte A2 qu'il gère, vers le compte A1 géré par le marchand M. Il envoie au 
service USSD, outre l'identifiant de la commande de transfert : son login, son 
mot de passe, le MSISDN du compte A2, le MSISDN du compte A1, et le montant de 
la transaction. La réponse USSD l'informe du bon déroulement, ou non, de 
l'opération, et deux SMS de notification résumant la transaction sont envoyés 
vers les SIM de A1 et A2.


Scénario 5 : transfert de crédit d'un compte à un autre

Le commercial C, qui gère les comptes A2 et A3, souhaite transférer du crédit 
de A3 vers A2 (afin par exemple de rassembler un reliquat de crédits 
éparpillés sur différents comptes).

Il communique au service USSD d'easy recharge les mêmes paramètres que pour 
vendre du crédit à un marchand, sauf que les deux comptes sont cette fois 
gérés par lui.


Scénario 6 : Cessation d'activité

Le marchand M souhaite ne plus offrir le service. Le compte A1 est désormais 
vide. Le commercial C, informé, récupère la carte SIM de A1 et envoie une 
commande USSD pour annuler la délégation de compte. Cette commande ne peut 
être émise que depuis la SIM de A1, avec le login et mot de passe du 
commercial C.

Un SMS de notification est envoyé à la SIM personnelle du commercial, et par 
commodité un SMS résumant l'opération est également envoyé à la SIM de A1.


Sécurisation :

Pour éviter que d'autres personnes que les personnes autorisée ne transfèrent 
du crédit (surtout important au niveau des marchands qui vendent directement 
aux abonnés), on peut utiliser le MSISDN personnel du marchand pour le tenir 
informer des transactions. Cependant, envoyer systématiquement un SMS sur 
cette SIM risque de saturer rapidement la mémoire de l'appareil. Il faut donc 
que le marchand vérifie les SMS de notifications qui sont envoyés sur la SIM 
des comptes gérés. Par ailleurs, on peut envisager d'expédier quotidiennement 
un SMS résumant les opérations sur les SIM personnelles.

En cas d'utilisation frauduleuse (par exemple, vol de la SIM d'un compte par 
une personne connaissant par ailleurs le mot de passe d'un utilisateur gérant 
ce compte), il faut évidement prévenir ATM qui a tous les moyens pour bloquer 
la SIM. On peut en outre offrir un service plus rapide : autoriser la SIM 
personnelle d'un utilisateur à bloquer un compte via USSD.



--gKMricLos+KVdGMg--
.
QUIT
